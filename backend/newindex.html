<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>新首页</title>
    <link rel="stylesheet" href="css/newindex.css">
    <link rel="stylesheet" href="css/popup.css">
</head>

<body>
    <div class="newidx-wrapper">
        <div class="newidx-title">
            <a href="#" class="newidx-tab">首页信息</a>
            <p>欢迎运营部 运营主管&nbsp;
                <strong>王永旭</strong>&nbsp;，您上次的登录时间是2018.1.31 12:30，自您退出登录后系统更新了10条与你相关的消息，点击进行查看，通过下方快捷功能可进行快速处理</p>
        </div>
        <div class="newidx-content">
            <div class="newidx-conleft">
                <div class="newidx-contab newidx-inp newidx-inp-two" draggable="false">
                    <h2>快速收款
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <input type="text" placeholder="请输入房间号" class="inpstyle">
                    <select name="" id="" class="inpstyle">
                        <option value="一年">一年</option>
                        <option value="二年">二年</option>
                        <option value="三年">三年</option>
                    </select>
                    <div class="btns">
                        <button class="bg-blue">核算</button>
                    </div>
                </div>
                <div class="newidx-contab newidx-statics" draggable="false">
                    <h2>收款统计
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>今日收款</h3>
                            <p class="small">
                                <span class="txt-blue">5</span>户</p>
                            <p class="medium">
                                <span class="txt-blue">1683.36</span>元</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>昨日收款</h3>
                            <p class="small">
                                <span class="txt-green">10</span>户</p>
                            <p class="medium">
                                <span class="txt-green">1683.36</span>元</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>本周累计收款</h3>
                            <p class="small">
                                <span class="txt-orange">5</span>户</p>
                            <p class="medium">
                                <span class="txt-orange">13213.33</span>元</p>
                        </div>
                    </div>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="false">
                    <h2>线上缴费
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>未结算</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>今日结算</h3>
                            <p class="large">
                                <span class="txt-green">10</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>待确认结算</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>户</p>
                        </div>
                    </div>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="false"> 
                    <h2>物业超市
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>今日订单</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>带配送订单</h3>
                            <p class="large">
                                <span class="txt-green">10</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>未配送完成</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>单</p>
                        </div>
                    </div>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="false">
                    <h2>物业超市结算
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>未结算</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>今日结算</h3>
                            <p class="large">
                                <span class="txt-green">10</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>待确认结算</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>户</p>
                        </div>
                    </div>
                </div>
                <div class="newidx-contab newidx-inp newidx-inp-one" draggable="false">
                    <h2>添加报修
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <input type="text" placeholder="请输入房间号" class="inpstyle">
                    <div class="btns">
                        <button class="bg-blue btn-right">查看</button>
                        <button class="bg-green">添加</button>
                    </div>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="false">
                    <h2>报修投诉统计
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>今日新上报</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>待处理报修</h3>
                            <p class="large">
                                <span class="txt-green">10</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>今日完成</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>单</p>
                        </div>
                    </div>
                </div>
                <div class="newidx-contab newidx-inp newidx-inp-one" draggable="false">
                    <h2>信息查询
                        <i></i>
                        <span class="more"></span>
                    </h2>
                    <input type="text" placeholder="请输入房间号" class="inpstyle">
                    <div class="btns">
                        <button class="bg-blue btn-right">房产</button>
                        <button class="bg-green btn-right">业主</button>
                        <button class="bg-orange">催缴</button>
                    </div>
                </div>
                <div class="newidx-contab newidx-add">
                    <span>+&nbsp;&nbsp;添加</span>
                </div>
            </div>
            <div class="newidx-conright">
                <i></i>
            </div>
        </div>

        <!-- 添加卡片浮层 -->
        <div class="popup-wrapper newidx-cards">
            <div class="popup-head">
                <i class="close"></i>
            </div>
            <div class="popup-container">
                <div class="newidx-contab newidx-inp newidx-inp-two" draggable="true">
                    <h2>快速收款<i></i><span class="more"></span></h2>
                    <input type="text" placeholder="请输入房间号" class="inpstyle">
                    <select name="" id="" class="inpstyle">
                        <option value="一年">一年</option>
                        <option value="二年">二年</option>
                        <option value="三年">三年</option>
                    </select>
                    <div class="btns">
                        <button class="bg-blue">核算</button>
                    </div>
                    <label class="check-card"></label>
                </div>
                <div class="newidx-contab newidx-statics" draggable="true">
                    <h2>收款统计<i></i><span class="more"></span></h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>今日收款</h3>
                            <p class="small">
                                <span class="txt-blue">5</span>户</p>
                            <p class="medium">
                                <span class="txt-blue">1683.36</span>元</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>昨日收款</h3>
                            <p class="small">
                                <span class="txt-green">10</span>户</p>
                            <p class="medium">
                                <span class="txt-green">1683.36</span>元</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>本周累计收款</h3>
                            <p class="small">
                                <span class="txt-orange">5</span>户</p>
                            <p class="medium">
                                <span class="txt-orange">13213.33</span>元</p>
                        </div>
                    </div>
                    <label class="check-card"></label>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="true">
                    <h2>线上缴费<i></i><span class="more"></span></h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>未结算</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>今日结算</h3>
                            <p class="large">
                                <span class="txt-green">10</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>待确认结算</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>户</p>
                        </div>
                    </div>
                    <label class="check-card"></label>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="true">
                    <h2>物业超市<i></i><span class="more"></span></h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>今日订单</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>带配送订单</h3>
                            <p class="large">
                                <span class="txt-green">10</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>未配送完成</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>单</p>
                        </div>
                    </div>
                    <label class="check-card"></label>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="true">
                    <h2>物业超市结算<i></i><span class="more"></span></h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>未结算</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>今日结算</h3>
                            <p class="large">
                                <span class="txt-green">10</span>户</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>待确认结算</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>户</p>
                        </div>
                    </div>
                    <label class="check-card"></label>
                </div>
                <div class="newidx-contab newidx-inp newidx-inp-one" draggable="true">
                    <h2>添加报修<i></i><span class="more"></span></h2>
                    <input type="text" placeholder="请输入房间号" class="inpstyle">
                    <div class="btns">
                        <button class="bg-blue btn-right">查看</button>
                        <button class="bg-green">添加</button>
                    </div>
                    <label class="check-card"></label>
                </div>
                <div class="newidx-contab newidx-statics newidx-statics-one" draggable="true">
                    <h2>报修投诉统计<i></i><span class="more"></span></h2>
                    <div class="newidx-statics-inner">
                        <div class="newidx-statics-item">
                            <h3>今日新上报</h3>
                            <p class="large">
                                <span class="txt-blue">5</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>待处理报修</h3>
                            <p class="large">
                                <span class="txt-green">10</span>单</p>
                        </div>
                        <div class="newidx-statics-item">
                            <h3>今日完成</h3>
                            <p class="large">
                                <span class="txt-orange">5</span>单</p>
                        </div>
                        <label class="check-card"></label>
                    </div>
                </div>
                <div class="newidx-contab newidx-inp newidx-inp-one" draggable="true">
                    <h2>信息查询<i></i><span class="more"></span></h2>
                    <input type="text" placeholder="请输入房间号" class="inpstyle">
                    <div class="btns">
                        <button class="bg-blue btn-right">房产</button>
                        <button class="bg-green btn-right">业主</button>
                        <button class="bg-orange">催缴</button>
                    </div>
                    <label class="check-card"></label>
                </div>

            </div>
            <div class="popup-footer">
                <button class="sure">确定</button>
                <button class="cancel">取消</button>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="js/jquery-3.2.1.js"></script>
    <script>
        // 编辑按钮
        $('.newidx-conright i').click(function () {
            if ($('.newidx-contab h2 i').attr('class') == 'minus') {
                $('.newidx-contab').attr('draggable', false)
                $('.newidx-contab h2 i').attr('class', '').removeClass('minus');
                $('.newidx-add').css('display', 'none');

            } else {
                $('.newidx-contab h2 i').attr('class', '').addClass('minus');
                $('.newidx-contab').attr('draggable', true)
                $('.newidx-add').css('display', 'inline-block');
                $('.newidx-add').css('display', 'inline-block');
            }
        });

        // 点击添加
        $('.newidx-conleft').on('click', '.newidx-add span', function () {
            $('.popup-wrapper').show();
        });
        // 关闭卡片浮层
        $('.close').click(function () {
            $('.popup-wrapper').hide();
        });
        // 取消关闭卡片浮层
        $('.cancel').click(function () {
            $('.popup-wrapper').hide();
        });


        $('.newidx-conleft').on('click', '.newidx-contab h2 i', function () {
            if ($(this).attr('class') == 'minus') { // 减去当前卡片
                $(this).parents('.newidx-contab').remove();
            } else { // 增加卡片
                $(this).parents('.newidx-contab').clone().insertBefore($('.newidx-conleft .newidx-add'));
            }
        });
        

        // 点击浮层的确定
        $('.sure').click(function () {
            var ischecked = $('.popup-wrapper .is-checked');
            console.log(ischecked)
            for(var i = 0 ; i < ischecked.length; i++){
                $(ischecked[i]).parents('.newidx-contab').clone().insertBefore($('.newidx-conleft .newidx-add'))
            }
            $('.popup-wrapper').hide();
        });

        // 选中当前卡片
        $(document).on('click', '.check-card', function() {
            $(this).toggleClass('is-checked');
        });


        // 拖拽开始
        $('.newidx-conleft').on('dragstart', '.newidx-contab', function (e) {
            e.originalEvent.dataTransfer.setData("cardId", $(this).index()); 
        });
        // 必须preventDefault() , drop才能生效
        $('.newidx-conleft').on('dragover', '.newidx-contab', function (e) {
            e.preventDefault(); 
        });
        $('.newidx-conleft').on('drop', '.newidx-contab', function (e) {
            var dragIdx = e.originalEvent.dataTransfer.getData("cardId");
            // 判断插入前面还是后面， 取决于 目标元素和拖拽元素的索引
            if($(this).index() > dragIdx){
                $('.newidx-contab').eq(dragIdx).insertAfter($(this));
            }else{
                $('.newidx-contab').eq(dragIdx).insertBefore($(this));
            }
        });

    </script>
</body>

</html>